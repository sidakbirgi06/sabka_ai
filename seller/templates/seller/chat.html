{% extends 'seller/app_base.html' %}

{% block app_content %}
    <h1 class="main-heading">Chatbot Testing Room</h1>
    <p class="section-description" style="text-align: center; margin-top: -20px; margin-bottom: 30px;">
        This is your private room to test your AI's responses.
        <a href="{% url 'chat_view' %}?new=true">Start New Conversation</a>
    </p>

    <div class="chat-container">
        <div id="chat-messages" class="chat-messages">
            {% if error %}
                <div class="message bot-message"><p>{{ error }}</p></div>
            {% endif %}

            {% for message in chat_history %}
                {% if message.role == 'bot' %}
                    <div class="message bot-message">
                        <p>{{ message.parts.0 }}</p>
                    </div>
                {% else %}
                     <div class="message user-message">
                        <p>{{ message.parts.0 }}</p>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
        <form method="post" class="chat-input-form">
            {% csrf_token %}
            <input type="text" name="message" class="chat-input" placeholder="Type your message..." autocomplete="off" autofocus>
            <button type="submit">Send</button>
        </form>
    </div>

    <script>
        const chatWindow = document.getElementById('chat-messages');
        chatWindow.scrollTop = chatWindow.scrollHeight;
    </script>
{% endblock app_content %}